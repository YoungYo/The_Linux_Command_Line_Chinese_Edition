# 第 3 章 探索 Linux 系统

既然我们已经知道了如何在文件系统中移动，那么是时候开始我们在 Linux 系统中的旅程了，但是在出发前，我们需要再多学习几个沿途能用得上的命令。

* `ls` - 列出目录中的内容
* `file`- 确定文件类型
* `less`- 查看文件内容

## 更加愉快地使用 ls

`ls`大概是使用最多的命令了吧，这是有充分理由的。使用`ls`可以查看一个目录包含的内容，并且知道一系列重要的文件和目录属性。就像我们已经知道的，我们可以简单地输入`ls`来获取当前工作目录包含的文件和子目录的列表。

```text
[me@linuxbox ~]$ ls
Desktop Documents Music Pictures Public Templates Videos
```

除了当前目录，我们还可以列出一个指定目录的内容，就像这样：

```text
me@linuxbox ~]$ ls /usr
bin games include lib local sbin share src
```

我们甚至可以指定多个目录。在下面的例子中，我们列出了家目录（用符号「~」表示）和`/usr`目录的内容。

```text
[me@linuxbox ~]$ ls ~ /usr
/home/me:
Desktop Documents Music Pictures Public Templates Videos
/usr:
bin games include lib local sbin share src
```

我们还可以改变输出的格式以展示更多内容。

```text
[me@linuxbox ~]$ ls -l
total 56
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Desktop
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Documents
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Music
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Pictures
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Public
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Templates
drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Videos
```

通过给`ls`加`-l`选项，命令的输出变成了长格式。

### 选项和参数

上面的讨论引出了一个非常重要的话题——大多数命令是如何工作的。命令后面经常会跟一个或多个选项——这些选项会改变命令的行为——以及一个或多个参数——该命令作用于参数之上。所以大多数命令看起来都是下面这个样子：

```text
command -options arguments
```

大多数命令使用的选项都是由一个短横加一个字符组成，比如「`-l`」。许多命令（包括 GNU 项目中的命令）也支持长选项，长选项是由两个短横加一个单词组成。还有很多命令也允许多个短选项串起来一块使用。在下面的例子中，`ls`命令有两个选项，分别是`l`选项（产生长格式的输出）和`t`选项（根据文件的修改时间排序）。

```text
[me@linuxbox ~]$ ls -lt
```

然后我们再加上一个长选项`--reverse`，使之倒序排列。

```text
[me@linuxbox ~]$ ls -lt --reverse
```

> **注意：**与文件名一样，Linux 中的命令选项也是大小写敏感的。

`ls`命令支持很多选项，表 3-1 列出了最常用的几个。

| 选项 | 长选项 | 功能描述 |
| :--- | :--- | :--- |
| -a | --all | 列出所有的文件，包括那些文件名以「.」开头的隐藏文件。 |
| -A | --almost-all | 作用与上面的`-a`选项类似，但是不会列出「.」（当前目录）和「..」（上一层目录） |
| -d | --directory | 正常情况下，如果给`ls`命令指定一个目录，它会列出这个目录所包含的内容，而不是这个目录自身。将此选项与`-l`选项一起使用，可以查看有关目录而不是目录内容的详细信息。 |
| -F | --classify | 这个选项会在列出的每一个文件名后面添加一个指示符，例如，如果是一个目录，则会在目录名后面添加一个正斜杠（/）。 |
| -h | --human-readable | 在长格式的列表中，将文件大小以人类容易识别的方式展示出来，而不是展示字节数。 |
| -l |  | 以长格式的方式展示结果 |
| -r | --reverse | 以倒序排列的方式展示结果。正常情况下，`ls`按照字母排列顺序展示结果。 |
| -S |  | 将文件按照大小进行排序。 |
| -t |  | 将文件按照修改时间进行排序。 |

### 

### 深入理解长格式

正如我们在前面看到的，`-l`选项能够让`ls`命令以长格式的方式输出结果。这种格式包含很多有用的信息。下面展示的是 Ubuntu 系统的`Examples`目录：

```text
-rw-r--r-- 1 root root 3576296 2017-04-03 11:05 Experience ubuntu.ogg
-rw-r--r-- 1 root root 1186219 2017-04-03 11:05 kubuntu-leaflet.png
-rw-r--r-- 1 root root 47584 2017-04-03 11:05 logo-Edubuntu.png
-rw-r--r-- 1 root root 44355 2017-04-03 11:05 logo-Kubuntu.png
-rw-r--r-- 1 root root 34391 2017-04-03 11:05 logo-Ubuntu.png
-rw-r--r-- 1 root root 32059 2017-04-03 11:05 oo-cd-cover.odf
-rw-r--r-- 1 root root 159744 2017-04-03 11:05 oo-derivatives.doc
-rw-r--r-- 1 root root 27837 2017-04-03 11:05 oo-maxwell.odt
-rw-r--r-- 1 root root 98816 2017-04-03 11:05 oo-trig.xls
-rw-r--r-- 1 root root 453764 2017-04-03 11:05 oo-welcome.odt
-rw-r--r-- 1 root root 358374 2017-04-03 11:05 ubuntu Sax.ogg
```

表 3-2 为我们提供了其中一个文件的不同字段及其含义。

| 字段 | 含义 |
| :--- | :--- |
| -rw-r--r-- | 文件访问权限。第一个字符用于指示文件类型，短横表示这是一个普通文件， “d”表示这是一个目录。接下来的三个字符代表该文件的所有者对于该文件的 访问权限，再接下来的三个字符代表该文件的所属组成员对该文件的访问权限， 最后的三个字符代表除了前两种用户之外的所有用户（即其他用户）对该文件的访问权限。在第9章——“权限”中我们会详细讨论这一块的具体含义。 |
| 1 | 该文件的硬链接的个数。本章后面的内容“硬链接”和“链接”介绍关于链接的内容。 |
| root | 文件所有者的用户名。 |
| root | 文件所属组的名字。 |
| 32059 | 文件的大小，单位是字节。 |
| 2007-04-03 11:05 | 最后一次修改文件的日期和时间。 |
| oo-cd-cover.odf | 文件名。 |

## 用`file`命令确定文件类型

在我们探索 Linux 系统的时候，知道一个文件包含什么内容至关重要。要想做到这一点，我们可以使用`file`命令来确定一个文件的类型。 正如我们之前讨论的，Linux 中不通过文件名来反映文件的内容。例如一个名为「picture.jpg」的文件，虽然我们一般会认为其中包含的应该是 JPEG 压缩图像， 但是在 Linux 中则不一定。我们可以通过下面这种方式调用`file`命令：

```text
file filename
```

被调用后，`file`会输出简短的文件内容的介绍。例如：

```text
[me@linuxbox ~]$ file picture.jpg
picture.jpg: JPEG image data, JFIF standard 1.01
```

文件类型有很多，事实上，像 Linux 这样的所有类 Unix 操作系统的一个共同点是「一切皆文件」。在本教程的推进过程中，我们将看到这句话是多么正确。

你对系统中的很多文件应该都很熟悉，例如 MP3 文件和 JPEG 文件，但是也有很多文件的类型不是太明显，有一些甚至相当奇怪。

## 用`less`命令查看文件内容

`less`命令可以查看文本文件的内容。在Linux系统中，有很多文件的内容是人类可读的文本，`less`提供了一种简便的方式去查看这些文件。

{% hint style="info" %}
### 什么是「文本」？

在计算机中表达信息有很多种方式，而每一种方式都要考虑，如何定义信息和用来表示信息的数字之间的关系。 毕竟，计算机只认识数字，所以所有的数据最后都要转换成数字。

一些表示系统非常复杂（比如压缩视频文件），但是也有一些就很简单。其中最早被使用也是最简单的一种方式就是_ASCII 文本_。 ASCII（发音为「As-Key」）是美国信息交换标准代码（American Standard Code for Information Interchange）的简称。 这是一种简单的编码方案，最早在 Teletype 机器上用于将键盘字符映射为数字。

文本是字符到数字的简单映射，非常紧凑。50 个字符被翻译成了 50 个字节。文本只包含字符到数字的简单映射，理解这一点至关重要， 它与诸如 Microsoft Word 或LibreOffice Writer 创建的文字处理程序文档不同。与简单的 ASCII 文本相反，这些文件包含许多非文本元素，用于描述其结构和格式。 纯 ASCII 文本文件仅包含字符本身，还包含一些基本的控制代码，例如制表符，回车符和换行符。

在整个 Linux 系统中，许多文件以文本格式存储，并且有许多处理文本文件的 Linux 工具。甚至 Windows 也意识到这种格式的重要性， 众所周知的 NOTEPAD.EXE 程序就是纯 ASCII 文本文件的编辑器。
{% endhint %}

我们为什么要检查文本文件？因为许多包含系统设置的文件（我们称这类文件为_配置文件_）都是以这种格式存储的。 学会阅读这些文件可以给我们一个内部视角去观察系统是如何运作的。除此之外，一些系统使用的真实程序（我们称这类文件为_脚本_）也是以这种格式存储的。 在后面的章节中，我们将学习如何通过编辑文本文件修改系统设置，并学习编写我们自己的脚本。现在我们只是先查看文本文件的内容。

`less`命令的用法如下：

```text
less filename
```

打开文件之后，`less`程序允许我们在文件中前后滚动。 例如，要检查定义所有系统用户帐户的文件，请输入以下命令：

```text
[me@linuxbox ~]$ less /etc/passwd
```

一旦`less`程序启动起来，我们就可以查看这个文件的内容了。 如果这个文件的长度超过了一页，我们可以上下滚动。按下`q`键可以退出`less`。 表 3-3 列出了`less`最常用的键盘命令。

| 命令 |  功能描述 |
| :--- | :--- |
| Page Up 或 b | 向上翻页 |
| Page Down 或 space | 向下翻页 |
| 上键 | 向上滚动一行 |
| 下键 | 向下滚动一行 |
| G | 移动到文本文件的末尾 |
| 1G 或 g | 移动到文本文件的开头 |
| /_搜索内容_ | 向前搜索下一个_搜索内容_出现的位置 |
| n | 搜索上一次搜索的下一次出现 |
| h | 展示帮助信息 |
| q | 退出`less` |

{% hint style="info" %}
### 少就是多

`less`程序是作为一个更早的 Unix 程序——`more`的升级替代品被设计出来的，「less」这个名字来自短语「less is more」（少就是多），这也是现代主义建筑师和设计师的座右铭。

`less`属于被称为「分页器」的那一类程序，这类程序允许用户以逐页的方式轻松查看长文本文档。`less`支持上下来回翻页以及许多其他特性，而`more`只能向下翻页。
{% endhint %}

## 导览

Linux 系统上的文件系统布局与其他类 Unix 系统非常相似。该设计实际上是在称为_Linux文件系统层次结构标准_的已发布标准中指定的。 并非所有 Linux 发行版都完全符合该标准，但是大多数发行版都非常接近。接下来，我们将自己在文件系统中四处逛逛，看看是什么让 Linux 系统运行起来。 这将使我们有机会练习导航技能。我们将发现，许多有趣的文件都是纯人类可读的文本。 在进行游览时，请尝试以下操作：

1. 使用`cd`进入一个给定的目录
2. 使用`ls -l`列出该目录下包含的内容
3. 如果你看到了感兴趣的文件，使用`file`确定它的的内容
4. 如果这个文件看上去可能是文本文件，那么就用`less`命令查看它的内容
5. 如果我们不小心尝试查看了非文本文件，并且它扰乱了终端窗口，则可以通过输入`reset`命令来恢复

{% hint style="warning" %}
**别忘了复制粘贴的技巧！**如果你在使用鼠标，那么你可以通过在一个文件名上双击来复制这个文件名，然后按下鼠标中建将它粘贴到命令中。
{% endhint %}

当我们四处闲逛时，不要害怕看东西。普通用户被最大程度地限制了，以防他们把系统搞砸——搞砸系统是系统管理员的事情！ 如果一个命令报错了，请继续进行其他操作。花一些时间环顾四周，这是我们要探索的系统。 记住，在 Linux 中没有秘密！

表 3-4 仅列出了我们可以探索的目录中的几个，根据我们的 Linux 发行版，可能会有一些细微的差异。 不要害怕，环顾四周，然后尝试更多操作！

_表 3-4：Linux 操作系统中的目录_

| 目录 | 说明 |
| :--- | :--- |
| `/` | 根目录。一切都开始于此 |
| `/bin` | 包含系统启动和运行时必须存在的二进制文件（程序） |
| `/boot` | 包含 Linux 内核、初始 RAM 磁盘映像（引导时所需的驱动程序）和引导加载程序。其中有一些有趣的文件：`/boot/grub/grub.conf`或者`menu.lst`，用于配置引导加载程序；`/boot/vmlinuz`（或者与此类似的文件），Linux 内核。 |
|  |  |
|  |  |



